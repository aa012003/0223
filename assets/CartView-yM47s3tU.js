import{a as c}from"./axios-L6U4YIEh.js";import{_ as y,c as n,a as t,F as m,e as b,t as d,o,n as v,f as C,d as p,g as f,v as k}from"./index-EW9bZN52.js";var x={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"joychiang",BASE_URL:"/joychiang/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:h,VITE_PATH:u}=x,L={data(){return{defineComponent:"",products:[],tempProduct:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},status:{addCartLoading:"",cartQtyLoading:"",removeLoading:""},carts:{}}},methods:{getProducts(){c.get(`${h}/api/${u}/products/all`).then(s=>{this.products=s.data.products})},openModal(s){this.tempProduct=s,this.$refs.userModal.open()},addCart(s,a=1){const g={productId:s,qty:a};this.status.addCartLoading=s,c.post(`${h}/api/${u}/cart`,{data:g}).then(_=>{console.log(_),alert(_.data.message),this.status.addCartLoading="",this.$refs.userModal.close(),this.getCart()})},changeCartQty(s,a=1){const g={productId:s.productId,qty:a};this.status.cartQtyLoading=s.id,c.put(`${h}/api/${u}/cart/${s.id}`,{data:g}).then(()=>{this.status.cartQtyLoading="",this.getCart()}).catch(_=>{alert(_.data.message)})},removeCartItem(s){this.status.removeLoading=s,c.delete(`${h}/api/${u}/cart/${s}`).then(a=>{alert(a.data.message),this.status.removeLoading="",this.getCart()}).catch(a=>{console.log(a)})},removeAllCart(){c.delete(`${h}/api/${u}/carts`).then(s=>{alert(s.data.message),this.getCart()}).catch(s=>{alert(s.data.message)})},createOrder(){const s=this.form;c.post(`${h}/api/${u}/order`,{data:s}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(a=>{alert(a.response.data.message)})},getCart(){c.get(`${h}/api/${u}/cart`).then(s=>{this.carts=s.data.data})}},components:{},mounted(){}},V=t("h2",null,"這是購物車列表",-1),$={class:"container"},w={class:"mt-4"},M={class:"table align-middle"},I=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),q={style:{width:"200px"}},E={key:0,class:"h5"},T={key:1},Q={class:"h6"},z={class:"h5"},A={class:"btn-group btn-group-sm"},P=["onClick"],U=["onClick","disabled"],B={key:0,class:"fas fa-spinner fa-pulse"},D={class:"text-end"},H={class:"table align-middle"},R=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),S=["onClick"],F={key:0,class:"fas fa-spinner fa-pulse"},N={key:1},O=t("div",{class:"text-success"},"已套用優惠券",-1),j={class:"input-group input-group-sm"},G={class:"input-group mb-3"},J=["onClick","disabled"],K=["onClick"],W=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[t("path",{d:`M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0
                        0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0
                         1 .5.5v6a.5.5 0 0
                         1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z`}),t("path",{d:`M14.5 3a1 1 0 0 1-1
                        1H13v9a2 2 0 0 1-2 2H5a2 2 0 0
                        1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1
                        0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0
                        1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4
                         4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z`})],-1),X=[W],Y=["onUpdate:modelValue","disabled"],Z=["onClick"],tt={class:"text-end"},et=t("small",{class:"text-success"},"折扣價：",-1),st=t("td",{colspan:"3",class:"text-end"},"總計",-1),at={class:"text-end"},nt=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),ot={class:"text-end text-success"};function lt(s,a,g,_,l,i){return o(),n(m,null,[V,t("div",$,[t("div",w,[t("table",M,[I,t("tbody",null,[(o(!0),n(m,null,b(l.products,e=>(o(),n("tr",{key:e.key},[t("td",q,[t("div",{style:v([{backgroundImage:`url(${e.imageUrl})`},{height:"150px","background-size":"cover","background-position":"center"}])},null,4)]),t("td",null,d(e.title),1),t("td",null,[e.price===e.origin_price?(o(),n("div",E,d(e.price)+" 元 ",1)):(o(),n("div",T,[t("del",Q,"原價 "+d(e.origin_price)+" 元",1),t("div",z,"現在只要 "+d(e.price)+" 元",1)]))]),t("td",null,[t("div",A,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:r=>i.openModal(e)}," 查看更多 ",8,P),t("button",{type:"button",class:"btn btn-outline-danger",onClick:r=>i.addCart(e.id),disabled:e.id===l.status.addCartLoading},[e.id===l.status.addCartLoading?(o(),n("i",B)):C("",!0),p(" 加到購物車 ")],8,U)])])]))),128))])]),t("div",D,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=e=>i.removeAllCart())}," 清空購物車 ")]),t("table",H,[R,t("tbody",null,[(o(!0),n(m,null,b(l.carts.carts,e=>(o(),n("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:r=>i.removeCartItem(e.id)},[e.id===l.status.removeLoading?(o(),n("i",F)):(o(),n("div",N,"x"))],8,S)]),t("td",null,[p(d(e.product.title)+" ",1),O]),t("td",null,[t("div",j,[t("div",G,[e.qty>1?(o(),n("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:r=>{e.qty--,i.changeCartQty(e,e.qty)},disabled:e.qty===1}," - ",8,J)):(o(),n("button",{key:1,type:"button",class:"btn btn-outline-danger",onClick:r=>i.removeCartItem(e.id)},X,8,K)),f(t("input",{min:"1",type:"number",class:"form-control text-end","onUpdate:modelValue":r=>e.qty=r,disabled:e.id===l.status.cartQtyLoading,readonly:""},null,8,Y),[[k,e.qty]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:r=>{e.qty++,i.changeCartQty(e,e.qty)}}," + ",8,Z)])])]),t("td",tt,[et,p(" "+d(e.total),1)])]))),128))]),t("tfoot",null,[t("tr",null,[st,t("td",at,d(l.carts.total),1)]),t("tr",null,[nt,t("td",ot,d(l.carts.final_total),1)])])])])])],64)}const rt=y(L,[["render",lt]]);export{rt as default};
